2025-07-27 18:07:01,082 - __main__ - INFO - 🚀 开始飞书同步功能频率限制测试
2025-07-27 18:07:01,082 - __main__ - INFO -    - 测试时间: 2025-07-27 18:07:01
2025-07-27 18:07:01,082 - __main__ - INFO - 
==================================================
2025-07-27 18:07:01,082 - __main__ - INFO - 📊 测试1: 频率限制器功能
2025-07-27 18:07:01,082 - __main__ - INFO - ==================================================
2025-07-27 18:07:01,082 - __main__ - INFO - 🧪 开始测试频率限制器功能
2025-07-27 18:07:01,082 - __main__ - INFO - 📊 测试应用级频率限制 (每秒3次)
2025-07-27 18:07:01,082 - __main__ - INFO -    - 第1次应用级调用成功
2025-07-27 18:07:01,082 - __main__ - INFO -    - 第2次应用级调用成功
2025-07-27 18:07:01,082 - __main__ - INFO -    - 第3次应用级调用成功
2025-07-27 18:07:01,082 - __main__ - INFO -    - 第4次应用级调用被限制
2025-07-27 18:07:02,087 - __main__ - INFO -    - 第4次应用级调用延迟后成功
2025-07-27 18:07:02,088 - __main__ - INFO -    - 第5次应用级调用成功
2025-07-27 18:07:02,088 - __main__ - INFO - ✅ 应用级频率限制测试完成，耗时: 1.01秒
2025-07-27 18:07:02,088 - __main__ - INFO - 📊 测试文档级频率限制 (每秒3次)
2025-07-27 18:07:02,088 - __main__ - INFO -    - 第1次文档级调用成功
2025-07-27 18:07:02,088 - __main__ - INFO -    - 第2次文档级调用成功
2025-07-27 18:07:02,088 - __main__ - INFO -    - 第3次文档级调用成功
2025-07-27 18:07:02,088 - __main__ - INFO -    - 第4次文档级调用被限制
2025-07-27 18:07:03,093 - __main__ - INFO -    - 第4次文档级调用延迟后成功
2025-07-27 18:07:03,094 - __main__ - INFO -    - 第5次文档级调用成功
2025-07-27 18:07:03,094 - __main__ - INFO - ✅ 文档级频率限制测试完成，耗时: 1.01秒
2025-07-27 18:07:03,094 - __main__ - INFO - 📊 测试指数退避算法
2025-07-27 18:07:03,094 - cloud_sync - INFO - 指数退避延迟: 1.08 秒 (尝试次数: 1)
2025-07-27 18:07:03,094 - __main__ - INFO -    - 尝试1: 延迟 1.08秒
2025-07-27 18:07:03,094 - cloud_sync - INFO - 指数退避延迟: 2.14 秒 (尝试次数: 2)
2025-07-27 18:07:03,094 - __main__ - INFO -    - 尝试2: 延迟 2.14秒
2025-07-27 18:07:03,094 - cloud_sync - INFO - 指数退避延迟: 4.39 秒 (尝试次数: 3)
2025-07-27 18:07:03,095 - __main__ - INFO -    - 尝试3: 延迟 4.39秒
2025-07-27 18:07:03,095 - cloud_sync - INFO - 指数退避延迟: 8.34 秒 (尝试次数: 4)
2025-07-27 18:07:03,095 - __main__ - INFO -    - 尝试4: 延迟 8.34秒
2025-07-27 18:07:03,095 - cloud_sync - INFO - 指数退避延迟: 16.82 秒 (尝试次数: 5)
2025-07-27 18:07:03,095 - __main__ - INFO -    - 尝试5: 延迟 16.82秒
2025-07-27 18:07:03,095 - __main__ - INFO - ✅ 频率限制器功能测试完成
2025-07-27 18:07:03,095 - __main__ - INFO - 
==================================================
2025-07-27 18:07:03,095 - __main__ - INFO - 📊 测试2: 带频率限制的飞书令牌获取
2025-07-27 18:07:03,095 - __main__ - INFO - ==================================================
2025-07-27 18:07:03,095 - __main__ - INFO - 🧪 开始测试带频率限制的飞书令牌获取
2025-07-27 18:07:03,096 - ConfigManager - INFO - 配置管理器初始化完成
2025-07-27 18:07:03,096 - __main__ - ERROR - ❌ 飞书令牌获取测试异常: 'ConfigManager' object has no attribute 'get_feishu_config'
2025-07-27 18:07:03,098 - __main__ - ERROR -    - 异常详情: Traceback (most recent call last):
  File "/Users/aron/twitter-daily-scraper/test_feishu_rate_limit.py", line 92, in test_feishu_token_with_rate_limit
    feishu_config = config_manager.get_feishu_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ConfigManager' object has no attribute 'get_feishu_config'

2025-07-27 18:07:03,098 - __main__ - INFO - 
==================================================
2025-07-27 18:07:03,098 - __main__ - INFO - 📊 测试3: 带频率限制的飞书同步功能
2025-07-27 18:07:03,098 - __main__ - INFO - ==================================================
2025-07-27 18:07:03,098 - __main__ - INFO - 🧪 开始测试带频率限制的飞书同步功能
2025-07-27 18:07:03,098 - ConfigManager - INFO - 配置管理器初始化完成
2025-07-27 18:07:03,098 - __main__ - ERROR - ❌ 飞书同步测试异常: 'ConfigManager' object has no attribute 'get_feishu_config'
2025-07-27 18:07:03,100 - __main__ - ERROR -    - 异常详情: Traceback (most recent call last):
  File "/Users/aron/twitter-daily-scraper/test_feishu_rate_limit.py", line 151, in test_feishu_sync_with_rate_limit
    feishu_config = config_manager.get_feishu_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ConfigManager' object has no attribute 'get_feishu_config'

2025-07-27 18:07:03,100 - __main__ - INFO - 
==================================================
2025-07-27 18:07:03,100 - __main__ - INFO - 📊 测试结果汇总
2025-07-27 18:07:03,100 - __main__ - INFO - ==================================================
2025-07-27 18:07:03,100 - __main__ - INFO -    - rate_limiter: ✅ 通过
2025-07-27 18:07:03,100 - __main__ - INFO -    - token_with_rate_limit: ❌ 失败
2025-07-27 18:07:03,100 - __main__ - INFO -    - sync_with_rate_limit: ❌ 失败
2025-07-27 18:07:03,100 - __main__ - INFO - 
📈 总体测试结果:
2025-07-27 18:07:03,100 - __main__ - INFO -    - 通过测试: 1/3
2025-07-27 18:07:03,100 - __main__ - INFO -    - 成功率: 33.3%
2025-07-27 18:07:03,100 - __main__ - ERROR - ❌ 飞书同步功能频率限制优化测试未通过，需要进一步调试
2025-07-27 18:09:27,128 - __main__ - INFO - 🚀 开始飞书同步功能频率限制测试
2025-07-27 18:09:27,128 - __main__ - INFO -    - 测试时间: 2025-07-27 18:09:27
2025-07-27 18:09:27,128 - __main__ - INFO - 
==================================================
2025-07-27 18:09:27,128 - __main__ - INFO - 📊 测试1: 频率限制器功能
2025-07-27 18:09:27,129 - __main__ - INFO - ==================================================
2025-07-27 18:09:27,129 - __main__ - INFO - 🧪 开始测试频率限制器功能
2025-07-27 18:09:27,129 - __main__ - INFO - 📊 测试应用级频率限制 (每秒3次)
2025-07-27 18:09:27,129 - __main__ - INFO -    - 第1次应用级调用成功
2025-07-27 18:09:27,129 - __main__ - INFO -    - 第2次应用级调用成功
2025-07-27 18:09:27,129 - __main__ - INFO -    - 第3次应用级调用成功
2025-07-27 18:09:27,129 - __main__ - INFO -    - 第4次应用级调用被限制
2025-07-27 18:09:28,134 - __main__ - INFO -    - 第4次应用级调用延迟后成功
2025-07-27 18:09:28,134 - __main__ - INFO -    - 第5次应用级调用成功
2025-07-27 18:09:28,135 - __main__ - INFO - ✅ 应用级频率限制测试完成，耗时: 1.01秒
2025-07-27 18:09:28,135 - __main__ - INFO - 📊 测试文档级频率限制 (每秒3次)
2025-07-27 18:09:28,135 - __main__ - INFO -    - 第1次文档级调用成功
2025-07-27 18:09:28,135 - __main__ - INFO -    - 第2次文档级调用成功
2025-07-27 18:09:28,135 - __main__ - INFO -    - 第3次文档级调用成功
2025-07-27 18:09:28,135 - __main__ - INFO -    - 第4次文档级调用被限制
2025-07-27 18:09:29,138 - __main__ - INFO -    - 第4次文档级调用延迟后成功
2025-07-27 18:09:29,138 - __main__ - INFO -    - 第5次文档级调用成功
2025-07-27 18:09:29,139 - __main__ - INFO - ✅ 文档级频率限制测试完成，耗时: 1.00秒
2025-07-27 18:09:29,139 - __main__ - INFO - 📊 测试指数退避算法
2025-07-27 18:09:29,139 - cloud_sync - INFO - 指数退避延迟: 1.10 秒 (尝试次数: 1)
2025-07-27 18:09:29,139 - __main__ - INFO -    - 尝试1: 延迟 1.10秒
2025-07-27 18:09:29,139 - cloud_sync - INFO - 指数退避延迟: 2.12 秒 (尝试次数: 2)
2025-07-27 18:09:29,139 - __main__ - INFO -    - 尝试2: 延迟 2.12秒
2025-07-27 18:09:29,140 - cloud_sync - INFO - 指数退避延迟: 4.20 秒 (尝试次数: 3)
2025-07-27 18:09:29,140 - __main__ - INFO -    - 尝试3: 延迟 4.20秒
2025-07-27 18:09:29,140 - cloud_sync - INFO - 指数退避延迟: 8.17 秒 (尝试次数: 4)
2025-07-27 18:09:29,140 - __main__ - INFO -    - 尝试4: 延迟 8.17秒
2025-07-27 18:09:29,140 - cloud_sync - INFO - 指数退避延迟: 16.31 秒 (尝试次数: 5)
2025-07-27 18:09:29,140 - __main__ - INFO -    - 尝试5: 延迟 16.31秒
2025-07-27 18:09:29,140 - __main__ - INFO - ✅ 频率限制器功能测试完成
2025-07-27 18:09:29,140 - __main__ - INFO - 
==================================================
2025-07-27 18:09:29,140 - __main__ - INFO - 📊 测试2: 带频率限制的飞书令牌获取
2025-07-27 18:09:29,140 - __main__ - INFO - ==================================================
2025-07-27 18:09:29,141 - __main__ - INFO - 🧪 开始测试带频率限制的飞书令牌获取
2025-07-27 18:09:29,141 - __main__ - ERROR - ❌ 飞书令牌获取测试异常: CloudSyncManager.__init__() got an unexpected keyword argument 'logger'
2025-07-27 18:09:29,142 - __main__ - ERROR -    - 异常详情: Traceback (most recent call last):
  File "/Users/aron/twitter-daily-scraper/test_feishu_rate_limit.py", line 100, in test_feishu_token_with_rate_limit
    sync_manager = CloudSyncManager(logger=logger)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CloudSyncManager.__init__() got an unexpected keyword argument 'logger'

2025-07-27 18:09:29,142 - __main__ - INFO - 
==================================================
2025-07-27 18:09:29,142 - __main__ - INFO - 📊 测试3: 带频率限制的飞书同步功能
2025-07-27 18:09:29,143 - __main__ - INFO - ==================================================
2025-07-27 18:09:29,143 - __main__ - INFO - 🧪 开始测试带频率限制的飞书同步功能
2025-07-27 18:09:29,143 - __main__ - INFO - 📋 创建测试数据: 3 条
2025-07-27 18:09:29,143 - __main__ - ERROR - ❌ 飞书同步测试异常: CloudSyncManager.__init__() got an unexpected keyword argument 'logger'
2025-07-27 18:09:29,143 - __main__ - ERROR -    - 异常详情: Traceback (most recent call last):
  File "/Users/aron/twitter-daily-scraper/test_feishu_rate_limit.py", line 186, in test_feishu_sync_with_rate_limit
    sync_manager = CloudSyncManager(logger=logger)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CloudSyncManager.__init__() got an unexpected keyword argument 'logger'

2025-07-27 18:09:29,143 - __main__ - INFO - 
==================================================
2025-07-27 18:09:29,143 - __main__ - INFO - 📊 测试结果汇总
2025-07-27 18:09:29,143 - __main__ - INFO - ==================================================
2025-07-27 18:09:29,143 - __main__ - INFO -    - rate_limiter: ✅ 通过
2025-07-27 18:09:29,143 - __main__ - INFO -    - token_with_rate_limit: ❌ 失败
2025-07-27 18:09:29,143 - __main__ - INFO -    - sync_with_rate_limit: ❌ 失败
2025-07-27 18:09:29,143 - __main__ - INFO - 
📈 总体测试结果:
2025-07-27 18:09:29,143 - __main__ - INFO -    - 通过测试: 1/3
2025-07-27 18:09:29,143 - __main__ - INFO -    - 成功率: 33.3%
2025-07-27 18:09:29,143 - __main__ - ERROR - ❌ 飞书同步功能频率限制优化测试未通过，需要进一步调试
2025-07-27 18:09:56,781 - __main__ - INFO - 🚀 开始飞书同步功能频率限制测试
2025-07-27 18:09:56,781 - __main__ - INFO -    - 测试时间: 2025-07-27 18:09:56
2025-07-27 18:09:56,781 - __main__ - INFO - 
==================================================
2025-07-27 18:09:56,781 - __main__ - INFO - 📊 测试1: 频率限制器功能
2025-07-27 18:09:56,781 - __main__ - INFO - ==================================================
2025-07-27 18:09:56,781 - __main__ - INFO - 🧪 开始测试频率限制器功能
2025-07-27 18:09:56,781 - __main__ - INFO - 📊 测试应用级频率限制 (每秒3次)
2025-07-27 18:09:56,781 - __main__ - INFO -    - 第1次应用级调用成功
2025-07-27 18:09:56,781 - __main__ - INFO -    - 第2次应用级调用成功
2025-07-27 18:09:56,781 - __main__ - INFO -    - 第3次应用级调用成功
2025-07-27 18:09:56,781 - __main__ - INFO -    - 第4次应用级调用被限制
2025-07-27 18:09:57,786 - __main__ - INFO -    - 第4次应用级调用延迟后成功
2025-07-27 18:09:57,787 - __main__ - INFO -    - 第5次应用级调用成功
2025-07-27 18:09:57,787 - __main__ - INFO - ✅ 应用级频率限制测试完成，耗时: 1.01秒
2025-07-27 18:09:57,787 - __main__ - INFO - 📊 测试文档级频率限制 (每秒3次)
2025-07-27 18:09:57,787 - __main__ - INFO -    - 第1次文档级调用成功
2025-07-27 18:09:57,787 - __main__ - INFO -    - 第2次文档级调用成功
2025-07-27 18:09:57,787 - __main__ - INFO -    - 第3次文档级调用成功
2025-07-27 18:09:57,787 - __main__ - INFO -    - 第4次文档级调用被限制
2025-07-27 18:09:58,792 - __main__ - INFO -    - 第4次文档级调用延迟后成功
2025-07-27 18:09:58,792 - __main__ - INFO -    - 第5次文档级调用成功
2025-07-27 18:09:58,793 - __main__ - INFO - ✅ 文档级频率限制测试完成，耗时: 1.01秒
2025-07-27 18:09:58,793 - __main__ - INFO - 📊 测试指数退避算法
2025-07-27 18:09:58,793 - cloud_sync - INFO - 指数退避延迟: 1.08 秒 (尝试次数: 1)
2025-07-27 18:09:58,793 - __main__ - INFO -    - 尝试1: 延迟 1.08秒
2025-07-27 18:09:58,793 - cloud_sync - INFO - 指数退避延迟: 2.18 秒 (尝试次数: 2)
2025-07-27 18:09:58,793 - __main__ - INFO -    - 尝试2: 延迟 2.18秒
2025-07-27 18:09:58,793 - cloud_sync - INFO - 指数退避延迟: 4.15 秒 (尝试次数: 3)
2025-07-27 18:09:58,793 - __main__ - INFO -    - 尝试3: 延迟 4.15秒
2025-07-27 18:09:58,793 - cloud_sync - INFO - 指数退避延迟: 8.35 秒 (尝试次数: 4)
2025-07-27 18:09:58,793 - __main__ - INFO -    - 尝试4: 延迟 8.35秒
2025-07-27 18:09:58,793 - cloud_sync - INFO - 指数退避延迟: 16.02 秒 (尝试次数: 5)
2025-07-27 18:09:58,793 - __main__ - INFO -    - 尝试5: 延迟 16.02秒
2025-07-27 18:09:58,793 - __main__ - INFO - ✅ 频率限制器功能测试完成
2025-07-27 18:09:58,793 - __main__ - INFO - 
==================================================
2025-07-27 18:09:58,793 - __main__ - INFO - 📊 测试2: 带频率限制的飞书令牌获取
2025-07-27 18:09:58,793 - __main__ - INFO - ==================================================
2025-07-27 18:09:58,793 - __main__ - INFO - 🧪 开始测试带频率限制的飞书令牌获取
2025-07-27 18:09:58,793 - CloudSync - INFO - 飞书配置设置成功
2025-07-27 18:09:58,793 - __main__ - INFO - ✅ 飞书配置设置成功
2025-07-27 18:09:58,794 - __main__ - INFO - 📊 测试多次令牌获取 (验证频率限制)
2025-07-27 18:09:58,794 - __main__ - INFO - 🔑 第1次令牌获取测试
2025-07-27 18:09:58,902 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:09:58,902 - cloud_sync - INFO - 指数退避延迟: 2.06 秒 (尝试次数: 1)
2025-07-27 18:10:01,106 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:01,107 - __main__ - INFO - ❌ 第1次令牌获取失败（这是预期的，因为使用了测试配置），耗时: 2.31秒
2025-07-27 18:10:02,112 - __main__ - INFO - 🔑 第2次令牌获取测试
2025-07-27 18:10:02,297 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:02,297 - cloud_sync - INFO - 指数退避延迟: 2.11 秒 (尝试次数: 1)
2025-07-27 18:10:04,551 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:04,553 - __main__ - INFO - ❌ 第2次令牌获取失败（这是预期的，因为使用了测试配置），耗时: 2.44秒
2025-07-27 18:10:05,558 - __main__ - INFO - 🔑 第3次令牌获取测试
2025-07-27 18:10:05,700 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:05,701 - cloud_sync - INFO - 指数退避延迟: 2.02 秒 (尝试次数: 1)
2025-07-27 18:10:07,839 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:07,839 - __main__ - INFO - ❌ 第3次令牌获取失败（这是预期的，因为使用了测试配置），耗时: 2.28秒
2025-07-27 18:10:07,839 - __main__ - INFO - ✅ 飞书令牌获取测试完成
2025-07-27 18:10:07,839 - __main__ - INFO - 
==================================================
2025-07-27 18:10:07,839 - __main__ - INFO - 📊 测试3: 带频率限制的飞书同步功能
2025-07-27 18:10:07,839 - __main__ - INFO - ==================================================
2025-07-27 18:10:07,839 - __main__ - INFO - 🧪 开始测试带频率限制的飞书同步功能
2025-07-27 18:10:07,839 - __main__ - INFO - 📋 创建测试数据: 3 条
2025-07-27 18:10:07,839 - CloudSync - INFO - 飞书配置设置成功
2025-07-27 18:10:07,840 - __main__ - INFO - ✅ 飞书配置设置成功
2025-07-27 18:10:07,840 - __main__ - INFO - 📤 开始执行飞书同步测试
2025-07-27 18:10:07,840 - CloudSync - INFO - 🚀 [CloudSync] 开始飞书同步流程
2025-07-27 18:10:07,840 - CloudSync - INFO -    - 数据条数: 3
2025-07-27 18:10:07,840 - CloudSync - INFO -    - 表格Token: test_sprea...
2025-07-27 18:10:07,840 - CloudSync - INFO -    - 表格ID: test_table_id
2025-07-27 18:10:07,840 - CloudSync - INFO -    - 最大重试次数: 3
2025-07-27 18:10:07,840 - CloudSync - INFO -    - 失败时继续执行: True
2025-07-27 18:10:07,840 - CloudSync - INFO - 🔑 [CloudSync] 尝试获取飞书访问令牌 (第1次)
2025-07-27 18:10:07,983 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:07,983 - cloud_sync - INFO - 指数退避延迟: 2.12 秒 (尝试次数: 1)
2025-07-27 18:10:10,240 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:10,241 - cloud_sync - INFO - 指数退避延迟: 5.42 秒 (尝试次数: 1)
2025-07-27 18:10:10,241 - CloudSync - WARNING - ⚠️ [CloudSync] 获取飞书令牌失败，5.42秒后重试 (尝试 1/3)
2025-07-27 18:10:15,660 - CloudSync - INFO - 🔑 [CloudSync] 尝试获取飞书访问令牌 (第2次)
2025-07-27 18:10:15,810 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:15,810 - cloud_sync - INFO - 指数退避延迟: 2.05 秒 (尝试次数: 1)
2025-07-27 18:10:18,037 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:18,037 - cloud_sync - INFO - 指数退避延迟: 10.36 秒 (尝试次数: 2)
2025-07-27 18:10:18,037 - CloudSync - WARNING - ⚠️ [CloudSync] 获取飞书令牌失败，10.36秒后重试 (尝试 2/3)
2025-07-27 18:10:28,401 - CloudSync - INFO - 🔑 [CloudSync] 尝试获取飞书访问令牌 (第3次)
2025-07-27 18:10:33,413 - CloudSync - ERROR - 获取飞书令牌网络异常: HTTPSConnectionPool(host='open.feishu.cn', port=443): Max retries exceeded with url: /open-apis/auth/v3/tenant_access_token/internal (Caused by ProxyError('Unable to connect to proxy', OSError('Tunnel connection failed: 503 Service Unavailable')))
2025-07-27 18:10:33,413 - cloud_sync - INFO - 指数退避延迟: 3.21 秒 (尝试次数: 1)
2025-07-27 18:10:36,754 - CloudSync - ERROR - 获取飞书令牌失败: invalid param
2025-07-27 18:10:36,755 - CloudSync - ERROR - ❌ [CloudSync] 飞书令牌获取失败，但继续执行任务
2025-07-27 18:10:36,755 - __main__ - INFO - ❌ 飞书同步测试失败（这是预期的，因为使用了测试配置），耗时: 28.92秒
2025-07-27 18:10:36,755 - __main__ - INFO - 
==================================================
2025-07-27 18:10:36,755 - __main__ - INFO - 📊 测试结果汇总
2025-07-27 18:10:36,755 - __main__ - INFO - ==================================================
2025-07-27 18:10:36,755 - __main__ - INFO -    - rate_limiter: ✅ 通过
2025-07-27 18:10:36,755 - __main__ - INFO -    - token_with_rate_limit: ✅ 通过
2025-07-27 18:10:36,756 - __main__ - INFO -    - sync_with_rate_limit: ✅ 通过
2025-07-27 18:10:36,756 - __main__ - INFO - 
📈 总体测试结果:
2025-07-27 18:10:36,756 - __main__ - INFO -    - 通过测试: 3/3
2025-07-27 18:10:36,756 - __main__ - INFO -    - 成功率: 100.0%
2025-07-27 18:10:36,756 - __main__ - INFO - 🎉 飞书同步功能频率限制优化测试基本通过!
