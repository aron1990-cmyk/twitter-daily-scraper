# 🚀 多窗口并行抓取指南

## 📖 功能概述

多窗口并行抓取器允许您同时运行多个AdsPower浏览器窗口，实现高效的Twitter数据采集。每个窗口都会实时显示其操作过程，包括页面导航、滚动、点击等动作，让您直观地看到抓取过程。

### ✨ 主要特点

- 🪟 **多窗口并行**: 同时运行2-8个浏览器窗口
- 👀 **实时可视化**: 每个窗口都显示真实的操作过程
- 🎯 **智能分配**: 自动将抓取任务分配给不同窗口
- 📊 **实时监控**: 动态显示每个窗口的状态和进度
- 🔄 **同步操作**: 窗口同步移动、滚动、点击
- 📈 **高效采集**: 显著提升数据采集效率

## 🛠️ 配置要求

### 1. AdsPower 配置

在 `config.py` 中配置多个用户ID：

```python
ADS_POWER_CONFIG = {
    'local_api_url': 'http://local.adspower.net:50325',
    'user_id': 'your_primary_user_id',
    
    # 多窗口模式配置
    'multi_user_ids': [
        'user_id_1',  # 窗口1
        'user_id_2',  # 窗口2
        'user_id_3',  # 窗口3
        'user_id_4',  # 窗口4
    ],
    
    'headless': False,      # 必须设为False以显示窗口
    'window_visible': True, # 确保窗口可见
}
```

### 2. 系统要求

- **内存**: 建议8GB以上（每个窗口约占用1-2GB）
- **CPU**: 多核处理器（推荐4核以上）
- **网络**: 稳定的网络连接
- **AdsPower**: 确保有足够的浏览器配置文件

## 🚀 使用方法

### 方法一：使用演示脚本（推荐）

```bash
# 使用默认4个窗口
python3 demo_multi_window.py

# 指定窗口数量（1-8个）
python3 demo_multi_window.py 6
```

### 方法二：直接调用

```python
import asyncio
from multi_window_scraper import MultiWindowScraper

async def main():
    # 创建4窗口抓取器
    scraper = MultiWindowScraper(num_windows=4)
    
    try:
        # 执行并行抓取
        output_file = await scraper.run_parallel_scraping()
        print(f"抓取完成: {output_file}")
    finally:
        await scraper.cleanup_all_windows()

asyncio.run(main())
```

## 📊 运行效果

### 启动过程

1. **初始化阶段**
   ```
   🚀 多窗口并行Twitter抓取器 - 2024-01-15 14:30:25
   ================================================================================
   🔄 窗口  1 | 启动浏览器          | 初始化中...                    | 推文:   0
   🔄 窗口  2 | 启动浏览器          | 初始化中...                    | 推文:   0
   🔄 窗口  3 | 启动浏览器          | 初始化中...                    | 推文:   0
   🔄 窗口  4 | 启动浏览器          | 初始化中...                    | 推文:   0
   ```

2. **抓取过程**
   ```
   🚀 多窗口并行Twitter抓取器 - 2024-01-15 14:32:15
   ================================================================================
   📱 窗口  1 | 抓取 @elonmusk      | 正在滚动加载推文...            | 推文:  12
   📱 窗口  2 | 抓取 @OpenAI        | 正在解析推文内容...            | 推文:   8
   🔍 窗口  3 | 搜索 'ChatGPT应用'  | 正在搜索关键词...              | 推文:   5
   🔍 窗口  4 | 搜索 'AI工具'       | 正在滚动加载搜索结果...        | 推文:  15
   ```

3. **完成状态**
   ```
   🚀 多窗口并行Twitter抓取器 - 2024-01-15 14:35:42
   ================================================================================
   🎉 窗口  1 | 完成               | 任务完成                       | 推文:  25
   🎉 窗口  2 | 完成               | 任务完成                       | 推文:  23
   🎉 窗口  3 | 完成               | 任务完成                       | 推文:  18
   🎉 窗口  4 | 完成               | 任务完成                       | 推文:  20
   ================================================================================
   💡 提示: 您可以看到各个浏览器窗口正在同步执行抓取任务
   📊 总计: 86 条推文
   ```

## 🎯 任务分配策略

### 自动分配

系统会自动将配置的目标账号和关键词平均分配给各个窗口：

```
📊 任务分配预览 (4 个窗口):
------------------------------------------------------------
🪟 窗口 1 (用户ID: k11p9ypc...):
   📱 账号 (4): elonmusk, OpenAI, sama, naval
   🔍 关键词 (6): ChatGPT应用, AI工具, 人工智能趋势, GPT-4, Claude, Midjourney

🪟 窗口 2 (用户ID: k11p9ypc...):
   📱 账号 (4): AndrewYNg, ylecun, karpathy, fchollet
   🔍 关键词 (6): 副业赚钱, 创业思维, 商业模式, 产品思维, 增长黑客, 技术趋势

🪟 窗口 3 (用户ID: k11p9ypc...):
   📱 账号 (4): reidhoffman, pmarca, balajis, jason
   🔍 关键词 (6): 编程技巧, 开发工具, 自动化, 学习方法, 时间管理, 认知升级

🪟 窗口 4 (用户ID: k11p9ypc...):
   📱 账号 (4): dotey, op7418, nishuang
   🔍 关键词 (2): 思维模型
```

## 🔧 高级配置

### 窗口数量优化

根据您的硬件配置选择合适的窗口数量：

- **2-4GB 内存**: 1-2个窗口
- **4-8GB 内存**: 2-4个窗口
- **8GB+ 内存**: 4-6个窗口
- **16GB+ 内存**: 6-8个窗口

### 性能调优

在 `config.py` 中调整以下参数：

```python
BROWSER_CONFIG = {
    'wait_time': 3,         # 减少等待时间提升速度
    'scroll_pause_time': 2, # 减少滚动间隔
    'timeout': 90000,       # 适当的超时时间
}
```

## 🚨 注意事项

### 1. 资源管理

- 多窗口会消耗更多系统资源
- 建议关闭其他不必要的应用程序
- 监控系统内存和CPU使用率

### 2. 网络限制

- 避免过于频繁的请求
- 适当增加延迟时间
- 使用不同的IP地址（如果可能）

### 3. AdsPower 配置

- 确保每个用户ID对应不同的浏览器配置文件
- 建议使用不同的代理IP
- 配置不同的浏览器指纹

## 🐛 故障排除

### 常见问题

1. **窗口启动失败**
   ```
   解决方案:
   - 检查AdsPower客户端是否运行
   - 验证用户ID是否正确
   - 确保有足够的系统资源
   ```

2. **抓取速度慢**
   ```
   解决方案:
   - 减少窗口数量
   - 增加网络带宽
   - 优化浏览器配置
   ```

3. **内存不足**
   ```
   解决方案:
   - 减少窗口数量
   - 关闭其他应用程序
   - 增加系统内存
   ```

### 日志分析

查看详细日志信息：

```bash
# 查看实时日志
tail -f twitter_scraper.log

# 搜索错误信息
grep "ERROR" twitter_scraper.log
```

## 📈 性能对比

| 模式 | 窗口数 | 预计时间 | 推文数量 | 资源占用 |
|------|--------|----------|----------|----------|
| 单窗口 | 1 | 20-30分钟 | 100-150 | 低 |
| 双窗口 | 2 | 12-18分钟 | 150-200 | 中 |
| 四窗口 | 4 | 8-12分钟 | 200-300 | 中高 |
| 六窗口 | 6 | 6-10分钟 | 300-400 | 高 |

## 🎉 最佳实践

1. **首次使用**: 从2个窗口开始测试
2. **稳定运行**: 确认系统稳定后再增加窗口
3. **监控资源**: 实时监控系统资源使用情况
4. **定期清理**: 定期清理浏览器缓存和日志
5. **备份配置**: 保存有效的配置文件

## 📞 技术支持

如果您在使用过程中遇到问题，请：

1. 查看日志文件 `twitter_scraper.log`
2. 检查系统资源使用情况
3. 验证AdsPower配置
4. 尝试减少窗口数量

---

**享受高效的多窗口并行抓取体验！** 🚀